function random(n,t){var i=t-n;return Math.random()*i+n}function cap(n,t,i){return Math.max(n,Math.min(i,t))}var __extends=this.__extends||function(n,t){function i(){this.constructor=n}i.prototype=t.prototype,n.prototype=new i},deg45=Math.PI/4,Quadrant=function(){function n(n){this.angle=n}return n.Tools=new n(1*deg45),n.Techniques=new n(3*deg45),n.Platforms=new n(-3*deg45),n.Languages=new n(-1*deg45),n.prototype.angleLower=function(){return this.angle-deg45},n.prototype.angleUpper=function(){return this.angle+deg45},n.prototype.isLeft=function(){return Math.abs(this.angle)<Math.PI/2},n}(),D3Node=function(){function n(n,t){this.x=n,this.y=t}return n}(),D3Link=function(){function n(n,t){this.source=n,this.target=t}return n}(),Thing=function(n){function t(t,i,r){n.call(this,null,null),this.name=t,this.quadrant=i;var u=r*Radar.radius,f=i.angle;this.polar=new Polar(u,f),this.updateXY()}return __extends(t,n),t.prototype.updatePolar=function(){this.prevPolar=this.polar,this.polar=Polar.fromPoint(this.x,this.y)},t.prototype.fixRadius=function(){this.isBeingDragged()||(this.polar.r=this.prevPolar.r)},t.prototype.updateXY=function(){this.x=this.polar.x(),this.y=this.polar.y()},t.prototype.isBeingDragged=function(){return this.fixed&2},t.prototype.goodness=function(){return this.polar.r/Radar.radius},t}(D3Node),Polar=function(){function n(n,t){this.r=n,this.phi=t}return n.fromPoint=function(t,i){return i=-i,new n(Math.sqrt(t*t+i*i),Math.atan2(i,t))},n.prototype.x=function(){return this.r*Math.cos(this.phi)},n.prototype.y=function(){return-this.r*Math.sin(this.phi)},n}(),Radar=function(){function n(n){this.width=n;this.drawBackground(10),this.setupForceLayout()}return n.radius=200,n.quadrantGravity=.03,n.prototype.addThings=function(n){var t=this;n.forEach(function(n){return t.things.push(n)}),this.restart()},n.prototype.drawBackground=function(t){var e=this.width/2,i=n.radius*2,r=n.radius+t,u=this.width/(n.radius*2),f;this.svg=d3.select("body").append("svg").attr("class","radar").attr("width",this.width*2).attr("height",this.width+t*2).append("g").attr("transform","scale("+u+") translate("+i+", "+r+")"),this.drawLine(0,n.radius*1.1,0,-n.radius*1.1),this.drawLine(n.radius*1.1,0,-n.radius*1.1,0),this.drawCenteredCircle(n.radius*.4),this.drawCenteredCircle(n.radius*.7),this.drawCenteredCircle(n.radius*.85),this.drawCenteredCircle(n.radius*.86),this.drawCenteredCircle(n.radius*1),f=d3.svg.arc().innerRadius(n.radius*.68).outerRadius(n.radius*.72).startAngle(0).endAngle(Math.PI/4)},n.prototype.setupForceLayout=function(){var t=this;this.force=d3.layout.force().nodes([]).size([n.radius*2,n.radius*2]).gravity(0).charge(-50).on("tick",function(n){return t.tick(n)}),this.things=this.force.nodes()},n.prototype.restart=function(){var n=this.svg.selectAll("circle.thing").data(this.things),t=n.enter().append("circle"),i;t.attr("class","thing").attr("r",6).call(this.force.drag),i=this.svg.selectAll("text.thing").data(this.things).enter().append("text").attr("class","thing").attr("dx",function(n){return(n.quadrant.isLeft()?1:-1)*12}).attr("dy",4).attr("text-anchor",function(n){return n.quadrant.isLeft()?"start":"end"}).text(function(n){return n.name}),this.force.start()},n.prototype.tick=function(t){this.things.forEach(function(i){i.updatePolar(),i.fixRadius(),i.polar.phi+=(i.quadrant.angle-i.polar.phi)*t.alpha*n.quadrantGravity;var r=10/(i.polar.r+.1);i.polar.phi=cap(i.quadrant.angleLower()+r,i.polar.phi,i.quadrant.angleUpper()-r),i.polar.r=Math.min(i.polar.r,n.radius),i.updateXY()});var i=this.width/2;this.svg.selectAll("circle.thing").attr("cx",function(n){return n.x}).attr("cy",function(n){return n.y}),this.svg.selectAll("text.thing").attr("x",function(n){return n.x}).attr("y",function(n){return n.y})},n.prototype.drawLine=function(n,t,i,r){this.svg.append("line").attr("class","lines").attr("x1",n).attr("y1",t).attr("x2",i).attr("y2",r)},n.prototype.drawCenteredCircle=function(n){this.svg.append("circle").attr("class","lines").attr("cx",0).attr("cy",0).attr("r",n)},n}();$(function(){var n=[new Thing("C++",Quadrant.Languages,.9),new Thing("Scala",Quadrant.Languages,.6),new Thing("TypeScript",Quadrant.Languages,.7),new Thing("C#",Quadrant.Languages,.1),new Thing("APL",Quadrant.Languages,.8),new Thing("Continuous Integration",Quadrant.Techniques,.8),new Thing("CodeSourcery GCC",Quadrant.Platforms,.5),new Thing("NCrunch",Quadrant.Tools,.5),new Thing("Git",Quadrant.Tools,.6),],i=[Quadrant.Languages,Quadrant.Platforms,Quadrant.Techniques,Quadrant.Tools],t;d3.range(60).forEach(function(t){return n.push(new Thing(t.toString(),i[t%4],random(.1,1)))}),t=new Radar(500),t.addThings(n)})